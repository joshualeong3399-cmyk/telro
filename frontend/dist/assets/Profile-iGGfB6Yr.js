import{u as F,j as e}from"./index-B5tky5X5.js";import{r as m}from"./vendor-DqoTkSux.js";import{N as a,T as S,l as g,K as y,Y as w,Z as n,A as C,O as l,q as T,R as E,D as i,a as z,S as N,B as t,aB as k,a1 as q,au as B,P as I,Q as x}from"./antd-BHLZumV9.js";import"./store-DlF-iav1.js";const{Title:O,Text:$}=S,A={admin:"red",operator:"orange",merchant:"blue",employee:"green"},D={admin:"管理员",operator:"运营商",merchant:"商家",employee:"员工"},K=()=>{const{user:s}=F(),[j,o]=m.useState(!1),[P,h]=m.useState(!1),[v,p]=m.useState(!1),[c]=a.useForm(),[d]=a.useForm(),R=async()=>{await c.validateFields(),h(!0),await new Promise(r=>setTimeout(r,600)),x.success("个人信息已更新"),h(!1),o(!1)},b=async()=>{const r=await d.validateFields();if(r.newPassword!==r.confirmPassword){x.error("两次输入的密码不一致");return}p(!0),await new Promise(f=>setTimeout(f,600)),x.success("密码已修改，下次登录请使用新密码"),d.resetFields(),p(!1)};return e.jsxs("div",{style:{maxWidth:720,margin:"0 auto"},children:[e.jsxs(O,{level:4,style:{marginBottom:20},children:[e.jsx(g,{})," 个人信息"]}),e.jsx(y,{title:"账号信息",extra:j?e.jsxs(N,{children:[e.jsx(t,{size:"small",onClick:()=>o(!1),children:"取消"}),e.jsx(t,{size:"small",type:"primary",icon:e.jsx(k,{}),loading:P,onClick:R,children:"保存"})]}):e.jsx(t,{size:"small",icon:e.jsx(q,{}),onClick:()=>{c.setFieldsValue({displayName:(s==null?void 0:s.displayName)??"",email:""}),o(!0)},children:"编辑"}),style:{marginBottom:16},children:e.jsxs(w,{gutter:24,align:"middle",children:[e.jsx(n,{flex:"none",children:e.jsx(C,{size:72,style:{background:"#1677ff",fontSize:28},children:((s==null?void 0:s.displayName)??(s==null?void 0:s.username)??"U").charAt(0).toUpperCase()})}),e.jsx(n,{flex:"auto",children:j?e.jsxs(a,{form:c,layout:"vertical",children:[e.jsxs(w,{gutter:12,children:[e.jsx(n,{span:12,children:e.jsx(a.Item,{name:"displayName",label:"显示名称",rules:[{required:!0,message:"请输入显示名称"}],children:e.jsx(l,{prefix:e.jsx(g,{})})})}),e.jsx(n,{span:12,children:e.jsx(a.Item,{name:"email",label:"邮箱",rules:[{type:"email",message:"邮箱格式不正确"}],children:e.jsx(l,{prefix:e.jsx(T,{}),placeholder:"your@email.com"})})})]}),e.jsx(a.Item,{name:"phone",label:"联系电话",children:e.jsx(l,{prefix:e.jsx(E,{}),placeholder:"可选"})})]}):e.jsxs(i,{column:1,size:"small",children:[e.jsx(i.Item,{label:"用户名",children:e.jsx($,{strong:!0,children:(s==null?void 0:s.username)??"—"})}),e.jsx(i.Item,{label:"显示名称",children:(s==null?void 0:s.displayName)??"—"}),e.jsx(i.Item,{label:"角色",children:e.jsx(z,{color:A[(s==null?void 0:s.role)??""]??"default",children:D[(s==null?void 0:s.role)??""]??(s==null?void 0:s.role)??"—"})})]})})]})}),e.jsx(y,{title:e.jsxs(e.Fragment,{children:[e.jsx(I,{})," 修改密码"]}),children:e.jsxs(a,{form:d,layout:"vertical",style:{maxWidth:400},children:[e.jsx(a.Item,{name:"currentPassword",label:"当前密码",rules:[{required:!0,message:"请输入当前密码"}],children:e.jsx(l.Password,{placeholder:"请输入当前密码"})}),e.jsx(B,{style:{margin:"8px 0"}}),e.jsx(a.Item,{name:"newPassword",label:"新密码",rules:[{required:!0,min:6,message:"密码至少6位"}],children:e.jsx(l.Password,{placeholder:"请输入新密码（至少6位）"})}),e.jsx(a.Item,{name:"confirmPassword",label:"确认新密码",rules:[{required:!0,message:"请确认新密码"},({getFieldValue:r})=>({validator(f,u){return!u||r("newPassword")===u?Promise.resolve():Promise.reject(new Error("两次输入的密码不一致"))}})],children:e.jsx(l.Password,{placeholder:"再次输入新密码"})}),e.jsx(a.Item,{children:e.jsx(t,{type:"primary",icon:e.jsx(I,{}),loading:v,onClick:b,children:"确认修改密码"})})]})})]})};export{K as default};
