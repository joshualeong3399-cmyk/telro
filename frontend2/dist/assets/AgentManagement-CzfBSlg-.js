import{a as u,j as t}from"./index-B5tky5X5.js";import{r as o}from"./vendor-DqoTkSux.js";import{N as r,a as K,S as R,B as y,a1 as _,a2 as B,a3 as D,T as P,K as U,O as m,a4 as V,a5 as Q,M as H,a6 as C,Q as f}from"./antd-BHLZumV9.js";import"./store-DlF-iav1.js";const p={list:n=>u.get("/agents",{params:n}),create:n=>u.post("/agents",n),update:(n,s)=>u.put(`/agents/${n}`,s),remove:n=>u.delete(`/agents/${n}`)},h={online:{label:"在线",color:"green"},busy:{label:"忙碌",color:"red"},away:{label:"休息",color:"orange"},offline:{label:"离线",color:"default"}},v=["销售组","客服组","技术支持组","VIP专属组","投诉处理组"],J=["张伟","李娜","王芳","刘洋","陈静","赵磊","孙敏","钱军","周婷","吴杰"],W=["online","busy","away","offline"],T=Array.from({length:25},(n,s)=>({id:s+1,agentNo:`A${String(s+1).padStart(3,"0")}`,name:J[s%10],extension:String(8001+s),status:W[s%4],skillGroup:v[s%5]})),te=()=>{const[n,s]=o.useState(T),[O,g]=o.useState(T.length),[A,S]=o.useState(!1),[x,j]=o.useState(1),[b,E]=o.useState(""),[F,i]=o.useState(!1),[c,w]=o.useState(null),[N,I]=o.useState(!1),[d]=r.useForm(),k=o.useCallback(async()=>{S(!0);try{const e=await p.list({page:x,pageSize:10,keyword:b});s(e.records),g(e.total)}catch{}finally{S(!1)}},[x,b]);o.useEffect(()=>{k()},[k]);const z=()=>{w(null),d.resetFields(),i(!0)},G=e=>{w(e),d.setFieldsValue(e),i(!0)},M=async e=>{try{await p.remove(e)}catch{}s(a=>a.filter(l=>l.id!==e)),g(a=>a-1),f.success("删除成功")},L=async()=>{I(!0);try{const e=await d.validateFields();if(c){try{await p.update(c.id,e)}catch{}s(a=>a.map(l=>l.id===c.id?{...l,...e}:l)),f.success("更新成功")}else{const a={...e,id:Date.now()};try{const l=await p.create(e);s(q=>[l,...q])}catch{s(l=>[a,...l])}g(l=>l+1),f.success("创建成功")}i(!1)}finally{I(!1)}},$=[{title:"坐席工号",dataIndex:"agentNo",key:"agentNo",width:100},{title:"姓名",dataIndex:"name",key:"name",width:100},{title:"分机号",dataIndex:"extension",key:"extension",width:100},{title:"状态",dataIndex:"status",key:"status",width:90,render:e=>t.jsx(K,{color:h[e].color,children:h[e].label}),filters:Object.entries(h).map(([e,a])=>({text:a.label,value:e})),onFilter:(e,a)=>a.status===e},{title:"技能组",dataIndex:"skillGroup",key:"skillGroup"},{title:"操作",key:"action",width:130,align:"center",render:(e,a)=>t.jsxs(R,{size:0,children:[t.jsx(y,{type:"link",size:"small",icon:t.jsx(_,{}),onClick:()=>G(a),children:"编辑"}),t.jsx(B,{title:"确定删除该坐席？",onConfirm:()=>M(a.id),children:t.jsx(y,{type:"link",size:"small",danger:!0,icon:t.jsx(D,{}),children:"删除"})})]})}];return t.jsxs("div",{children:[t.jsx(P.Title,{level:4,style:{marginBottom:16},children:"坐席管理"}),t.jsxs(U,{children:[t.jsxs("div",{style:{marginBottom:16,display:"flex",gap:8},children:[t.jsx(m.Search,{placeholder:"搜索工号/姓名/分机号...",style:{width:280},allowClear:!0,onSearch:e=>{j(1),E(e)}}),t.jsx(y,{type:"primary",icon:t.jsx(V,{}),onClick:z,children:"新建坐席"})]}),t.jsx(Q,{dataSource:n,columns:$,rowKey:"id",loading:A,size:"middle",pagination:{current:x,pageSize:10,total:O,onChange:e=>j(e),showSizeChanger:!1,showTotal:e=>`共 ${e} 条`}})]}),t.jsx(H,{title:c?"编辑坐席":"新建坐席",open:F,onOk:L,onCancel:()=>i(!1),confirmLoading:N,destroyOnClose:!0,width:480,children:t.jsxs(r,{form:d,layout:"vertical",style:{marginTop:16},children:[t.jsx(r.Item,{name:"agentNo",label:"坐席工号",rules:[{required:!0,message:"请输入坐席工号"}],children:t.jsx(m,{placeholder:"如：A001"})}),t.jsx(r.Item,{name:"name",label:"姓名",rules:[{required:!0,message:"请输入姓名"}],children:t.jsx(m,{placeholder:"坐席姓名"})}),t.jsx(r.Item,{name:"extension",label:"分机号",rules:[{required:!0,message:"请输入分机号"}],children:t.jsx(m,{placeholder:"如：8001"})}),t.jsx(r.Item,{name:"status",label:"状态",rules:[{required:!0}],initialValue:"offline",children:t.jsx(C,{options:Object.entries(h).map(([e,a])=>({value:e,label:a.label}))})}),t.jsx(r.Item,{name:"skillGroup",label:"技能组",rules:[{required:!0,message:"请选择技能组"}],children:t.jsx(C,{placeholder:"选择技能组",options:v.map(e=>({value:e,label:e}))})})]})})]})};export{te as default};
